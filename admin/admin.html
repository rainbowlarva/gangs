<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Update Google Sheet</title>
  <link rel="stylesheet" href="sheets.css">
</head>
<body class="background">
  <header>
    <h1>Injunction Panel</h1>
  </header>
  <main>
    <div class="admin-container">
      <form id="sheetForm">
        <div>
          <label for="name">Injunction Name:</label>
          <input type="text" id="name" name="name" placeholder="Enter name" required>
        </div>
        <div>
          <label for="image">Injunction Safetyzone:</label>
          <input type="file" id="image" name="image" accept="image/*" required>
        </div>
        <button type="submit">Add Injunction</button>
      </form>
    </div>
    <div id="status"></div>
  </main>
  <script>
    document.getElementById('sheetForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const imageInput = document.getElementById('image');
      if (!imageInput.files || !imageInput.files[0]) {
          alert("Please select an image file.");
          return;
      }
      const imageFile = imageInput.files[0];

      // Convert image file to a base64 data URL
      const reader = new FileReader();
      reader.onload = async function() {
          const imageData = reader.result; // Base64 data URL
          const payload = {
              name: name,
              imageData: imageData
          };
          // Replace YOUR_SCRIPT_ID with your deployed Google Apps Script ID
          const url = 'https://script.google.com/macros/s/AKfycbwfvD19CUQaNyiSTNomRq8V15qpW8WBbsEjGuOESQ56kY8q3_EWgIRi8Bbkpo4ktQeB/exec';
          try {
              const response = await fetch(url, {
                  method: 'POST',
                  mode: 'cors',
                  headers: {
                      'Content-Type': 'application/json'
                  },
                  body: JSON.stringify(payload)
              });
              const result = await response.json();
              document.getElementById('status').textContent = 'Updated successfully!';
          } catch (error) {
              console.error(error);
              document.getElementById('status').textContent = 'Error updating sheet.';
          }
      };
      reader.readAsDataURL(imageFile);
    });
  </script>
</body>
</html>
